{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 136, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Vishal%20Nath%20Tiwari/Downloads/ghrig/app/api/career/route.ts"],"sourcesContent":["export const runtime = \"nodejs\"; // âœ… Required for Nodemailer on Vercel\r\n\r\nimport { NextResponse } from \"next/server\";\r\nimport nodemailer from \"nodemailer\";\r\n\r\nexport async function POST(req: Request) {\r\n  try {\r\n    const form = await req.formData();\r\n\r\n    const fullName = form.get(\"fullName\")?.toString() || \"\";\r\n    const email = form.get(\"email\")?.toString() || \"\";\r\n    const phone = form.get(\"phone\")?.toString() || \"\";\r\n    const address = form.get(\"address\")?.toString() || \"\";\r\n    const pin = form.get(\"pin\")?.toString() || \"\";\r\n    const message = form.get(\"message\")?.toString() || \"\";\r\n\r\n    if (!fullName || !email || !phone || !address || !pin) {\r\n      return NextResponse.json(\r\n        { error: \"Missing required fields\" },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    const cv = form.get(\"cv\") as File | null;\r\n    const attachments: any[] = [];\r\n\r\n    if (cv && typeof cv !== \"string\") {\r\n      const arrayBuffer = await cv.arrayBuffer();\r\n      const buffer = Buffer.from(arrayBuffer);\r\n      attachments.push({\r\n        filename: (cv as any).name || \"Resume.pdf\",\r\n        content: buffer,\r\n      });\r\n    }\r\n\r\n    const transporter = nodemailer.createTransport({\r\n      service: \"gmail\",\r\n      auth: {\r\n        user: process.env.SMTP_USER,\r\n        pass: process.env.SMTP_PASS,\r\n      },\r\n      tls: {\r\n        rejectUnauthorized: false,\r\n      },\r\n    });\r\n\r\n    const toEmail = process.env.TO_EMAIL || process.env.SMTP_USER;\r\n\r\n    const mailOptions = {\r\n      from: `\"GHRIG Careers\" <${process.env.SMTP_USER}>`,\r\n      to: toEmail,\r\n      subject: `New Career Application from ${fullName}`,\r\n      replyTo: email,\r\n      text: `\r\nNew Career Application (GHRIG)\r\n\r\nName: ${fullName}\r\nEmail: ${email}\r\nPhone: ${phone}\r\nAddress: ${address}\r\nPin Code: ${pin}\r\n\r\nMessage:\r\n${message || \"No message provided\"}\r\n\r\nResume is attached.\r\n      `,\r\n      attachments,\r\n    };\r\n\r\n    await transporter.sendMail(mailOptions);\r\n\r\n    return NextResponse.json({ success: true });\r\n  } catch (err: any) {\r\n    return NextResponse.json(\r\n      { error: err.message || \"Internal Server Error\" },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;;AAEA;AACA;AAHO,MAAM,UAAU,UAAU,sCAAsC;;;AAKhE,eAAe,KAAK,GAAY;IACrC,IAAI;QACF,MAAM,OAAO,MAAM,IAAI,QAAQ;QAE/B,MAAM,WAAW,KAAK,GAAG,CAAC,aAAa,cAAc;QACrD,MAAM,QAAQ,KAAK,GAAG,CAAC,UAAU,cAAc;QAC/C,MAAM,QAAQ,KAAK,GAAG,CAAC,UAAU,cAAc;QAC/C,MAAM,UAAU,KAAK,GAAG,CAAC,YAAY,cAAc;QACnD,MAAM,MAAM,KAAK,GAAG,CAAC,QAAQ,cAAc;QAC3C,MAAM,UAAU,KAAK,GAAG,CAAC,YAAY,cAAc;QAEnD,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC,SAAS,CAAC,WAAW,CAAC,KAAK;YACrD,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAA0B,GACnC;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,KAAK,KAAK,GAAG,CAAC;QACpB,MAAM,cAAqB,EAAE;QAE7B,IAAI,MAAM,OAAO,OAAO,UAAU;YAChC,MAAM,cAAc,MAAM,GAAG,WAAW;YACxC,MAAM,SAAS,OAAO,IAAI,CAAC;YAC3B,YAAY,IAAI,CAAC;gBACf,UAAU,AAAC,GAAW,IAAI,IAAI;gBAC9B,SAAS;YACX;QACF;QAEA,MAAM,cAAc,4JAAU,CAAC,eAAe,CAAC;YAC7C,SAAS;YACT,MAAM;gBACJ,MAAM,QAAQ,GAAG,CAAC,SAAS;gBAC3B,MAAM,QAAQ,GAAG,CAAC,SAAS;YAC7B;YACA,KAAK;gBACH,oBAAoB;YACtB;QACF;QAEA,MAAM,UAAU,QAAQ,GAAG,CAAC,QAAQ,IAAI,QAAQ,GAAG,CAAC,SAAS;QAE7D,MAAM,cAAc;YAClB,MAAM,CAAC,iBAAiB,EAAE,QAAQ,GAAG,CAAC,SAAS,CAAC,CAAC,CAAC;YAClD,IAAI;YACJ,SAAS,CAAC,4BAA4B,EAAE,UAAU;YAClD,SAAS;YACT,MAAM,CAAC;;;MAGP,EAAE,SAAS;OACV,EAAE,MAAM;OACR,EAAE,MAAM;SACN,EAAE,QAAQ;UACT,EAAE,IAAI;;;AAGhB,EAAE,WAAW,sBAAsB;;;MAG7B,CAAC;YACD;QACF;QAEA,MAAM,YAAY,QAAQ,CAAC;QAE3B,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAK;IAC3C,EAAE,OAAO,KAAU;QACjB,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO,IAAI,OAAO,IAAI;QAAwB,GAChD;YAAE,QAAQ;QAAI;IAElB;AACF","debugId":null}}]
}